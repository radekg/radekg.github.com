<!DOCTYPE html>
<html lang="en">
    <head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
    <meta charset="UTF-8" />

    <meta name="generator" content="Hugo 0.101.0" /><meta name="theme-color" content="#fff" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <meta name="format-detection" content="telephone=no, date=no, address=no, email=no" />
    
    <meta http-equiv="Cache-Control" content="no-transform" />
    
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    <title>YugabyteDB change data capture | gruchalski.com</title>

    <link rel="stylesheet" href="/css/meme.min.2a066069a1d2940b3a3107397cddde65473ce8d29a2313ccc3989759c9372a79.css"/>

    
    
        <script src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js" defer></script><script src="/js/meme.min.4424cdd0b18f6756065b96014474fe67611675b5e5cf63462b9fe0ac9a2c27d3.js"></script>

    

    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=IBM&#43;Plex&#43;Serif:ital,wght@0,400;0,500;0,700;1,400;1,700&amp;family=Source&#43;Code&#43;Pro:ital,wght@0,400;0,700;1,400;1,700&amp;family=Amaranth&amp;display=swap" media="print" onload="this.media='all'" />
        <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=IBM&#43;Plex&#43;Serif:ital,wght@0,400;0,500;0,700;1,400;1,700&amp;family=Source&#43;Code&#43;Pro:ital,wght@0,400;0,700;1,400;1,700&amp;family=Amaranth&amp;display=swap" /></noscript>

    <meta name="author" content="Radek Gruchalski" /><meta name="description" content="real-time systems &#43; distributed SQL" />

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#2a6df4" />
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-title" content="gruchalski.com" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="application-name" content="gruchalski.com" />
    <meta name="msapplication-starturl" content="../../" />
    <meta name="msapplication-TileColor" content="#fff" />
    <meta name="msapplication-TileImage" content="../../icons/mstile-150x150.png" />
    <link rel="manifest" href="/manifest.json" />

    
    

    
    
        <link rel="canonical" href="https://gruchalski.com/posts/2022-02-23-yugabytedb-change-data-capture/" />
    

    

<script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "datePublished": "2022-02-23T00:00:00+00:00",
        "dateModified": "2022-03-22T01:28:59+01:00",
        "url": "https://gruchalski.com/posts/2022-02-23-yugabytedb-change-data-capture/",
        "headline": "YugabyteDB change data capture",
        "description": "real-time systems + distributed SQL",
        "inLanguage" : "en",
        "articleSection": "posts",
        "wordCount":  3103 ,
        "image": "https://gruchalski.com/icons/apple-touch-icon.png",
        "author": {
            "@type": "Person",
            "email": "radek@gruchalski.com",
            "image": "https://gruchalski.com/icons/apple-touch-icon.png",
            "url": "https://io-oi.me/",
            "name": "radek gruchalski"
        },
        "license": "[reposting requires attribution, **use canonical links** Â»](https://en.wikipedia.org/wiki/Canonical_link_element)",
        "publisher": {
            "@type": "Organization",
            "name": "gruchalski.com",
            "logo": {
                "@type": "ImageObject",
                "url": "https://gruchalski.com/icons/apple-touch-icon.png"
            },
            "url": "https://gruchalski.com/"
        },
        "mainEntityOfPage": {
            "@type": "WebSite",
            "@id": "https://gruchalski.com/"
        }
    }
</script>

    

<meta name="twitter:card" content="summary" />


    



<meta property="og:title" content="YugabyteDB change data capture" />
<meta property="og:description" content="real-time systems &#43; distributed SQL" />
<meta property="og:url" content="https://gruchalski.com/posts/2022-02-23-yugabytedb-change-data-capture/" />
<meta property="og:site_name" content="gruchalski.com" />
<meta property="og:locale" content="en" /><meta property="og:image" content="https://gruchalski.com/icons/apple-touch-icon.png" />
        <meta property="og:type" content="article" />
    <meta property="article:published_time" content="2022-02-23T00:00:00&#43;00:00" />
    <meta property="article:modified_time" content="2022-03-22T01:28:59&#43;01:00" />
    
    <meta property="article:section" content="posts" />


        <link rel="preconnect" href="https://www.google-analytics.com" crossorigin />

        




    
    <script>
        var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
        var doNotTrack = (dnt == "1" || dnt == "yes");
        if (!doNotTrack) {
            window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
            if (window.sessionStorage) {
                var GA_SESSION_STORAGE_KEY = 'ga:clientId';
                ga('create', 'UA-39073034-1', {
                'storage': 'none',
                'clientId': sessionStorage.getItem(GA_SESSION_STORAGE_KEY)
               });
               ga(function(tracker) {
                sessionStorage.setItem(GA_SESSION_STORAGE_KEY, tracker.get('clientId'));
               });
           }
            ga('set', 'anonymizeIp', true);
            ga('send', 'pageview');
        }
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    


    
    

    
</head>

    <body>
        <div class="container">
            
    <header class="header">
        
            <div class="header-wrapper">
                <div class="header-inner single">
                    
    <div class="site-brand">
        
            <a href="/" class="brand">gruchalski.com</a>
        
    </div>

                    <nav class="nav">
    <ul class="menu" id="menu">
        
            
        
        
        
        
            
                <li class="menu-item"><a href="/posts/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon archive"><path d="M32 448c0 17.7 14.3 32 32 32h384c17.7 0 32-14.3 32-32V160H32v288zm160-212c0-6.6 5.4-12 12-12h104c6.6 0 12 5.4 12 12v8c0 6.6-5.4 12-12 12H204c-6.6 0-12-5.4-12-12v-8zM480 32H32C14.3 32 0 46.3 0 64v48c0 8.8 7.2 16 16 16h480c8.8 0 16-7.2 16-16V64c0-17.7-14.3-32-32-32z"/></svg><span class="menu-item-name">posts</span></a>
                </li>
            
        
            
                <li class="menu-item"><a href="/categories/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" class="icon code-branch"><path d="M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z"/></svg><span class="menu-item-name">categories</span></a>
                </li>
            
        
            
                <li class="menu-item"><a href="/tags/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" class="icon tags"><path d="M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z"/></svg><span class="menu-item-name">tags</span></a>
                </li>
            
        
            
                <li class="menu-item"><a href="/about/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" class="icon user-circle"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 96c48.6 0 88 39.4 88 88s-39.4 88-88 88-88-39.4-88-88 39.4-88 88-88zm0 344c-58.7 0-111.3-26.6-146.5-68.2 18.8-35.4 55.6-59.8 98.5-59.8 2.4 0 4.8.4 7.1 1.1 13 4.2 26.6 6.9 40.9 6.9 14.3 0 28-2.7 40.9-6.9 2.3-.7 4.7-1.1 7.1-1.1 42.9 0 79.7 24.4 98.5 59.8C359.3 421.4 306.7 448 248 448z"/></svg><span class="menu-item-name">about</span></a>
                </li>
            
        
            
                <li class="menu-item"><a href="/privacy/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 192 512" class="icon info"><path d="M20 424.229h20V279.771H20c-11.046 0-20-8.954-20-20V212c0-11.046 8.954-20 20-20h112c11.046 0 20 8.954 20 20v212.229h20c11.046 0 20 8.954 20 20V492c0 11.046-8.954 20-20 20H20c-11.046 0-20-8.954-20-20v-47.771c0-11.046 8.954-20 20-20zM96 0C56.235 0 24 32.235 24 72s32.235 72 72 72 72-32.235 72-72S135.764 0 96 0z"/></svg><span class="menu-item-name">privacy</span></a>
                </li>
            
        
            
                <li class="menu-item"><a href=""></a>
                </li>
            
        
            
                
            
        
    </ul>
</nav>

                    
                </div>
            </div>
            
    <input type="checkbox" id="nav-toggle" aria-hidden="true" />
    <label for="nav-toggle" class="nav-toggle"></label>
    <label for="nav-toggle" class="nav-curtain"></label>


        
    </header>




            
            
    <main class="main single" id="main">
    <div class="main-inner">

        

        <article class="content post h-entry" data-align="default" data-type="posts" data-toc-num="true">

            <h1 class="post-title p-name">YugabyteDB change data capture</h1>

            

            
                <div class="post-description p-summary">real-time systems + distributed SQL</div>
                
            

            
                

<div class="post-meta">
    
        
        <time datetime="2022-02-23T00:00:00&#43;00:00" class="post-meta-item published dt-published"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon post-meta-icon"><path d="M148 288h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm108-12v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 96v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm192 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96-260v352c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h48c26.5 0 48 21.5 48 48zm-48 346V160H48v298c0 3.3 2.7 6 6 6h340c3.3 0 6-2.7 6-6z"/></svg>&nbsp;February 23, 2022</time>
    
    
    
    
        
        
        
    
    
        
        <span class="post-meta-item wordcount"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon post-meta-icon"><path d="M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3 0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9 0l60.1 60.1c18.8 18.7 18.8 49.1 0 67.9zM284.2 99.8L21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3 0-17l-111-111c-4.8-4.7-12.4-4.7-17.1 0zM124.1 339.9c-5.5-5.5-5.5-14.3 0-19.8l154-154c5.5-5.5 14.3-5.5 19.8 0s5.5 14.3 0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8 0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"/></svg>&nbsp;3103</span>
    
    
        
        <span class="post-meta-item reading-time"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon post-meta-icon"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm61.8-104.4l-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"/></svg>&nbsp;15&nbsp;mins</span>
    
    
    
</div>

            

            

            <div class="post-body e-content">
              <div class="infobox">
<p><strong>19th of March, 2022:</strong><br>
Interested in YugabyteDB CDC? YugabyteDB 2.13 comes with an all-new beta of a CDC SDK: <a href="/posts/2022-03-19-yugabytedb-cdc-sdk-beta-a-high-level-overview/">YugabyteDB CDC SDK beta, a high level overview</a>.</p>
</div>
<p>Today I&rsquo;m going to look at change data capture (CDC) in YugabyteDB. Change data capture is a data integration method based on the identification, capture, and delivery of data changes. Enterprises can choose this method to identify what data changes in the database and to act on those changes in real-time. What are the use cases for CDC? For example:</p>
<ul>
<li>A fulfillment enterprise can track new stock booking-ins and automatically fulfill backorders.</li>
<li>An enterprise can track account creation and modification to trigger automatic CRM updates.</li>
<li>An online shop can react to updates in exchange rates to automatically recalculate prices for different currencies.</li>
<li>A compliance department can automatically detect when certain user accounts or any other item in the database does not comply with a legal framework.</li>
<li>In the simplest form, organizations can synchronize different databases in real-time. However, YugabyteDB offers a feature called <em>xCluster</em>, an asynchronous cluster to cluster replication.</li>
</ul>
<p>Possibilities are endless and can be applied to pretty much every possible business problem. The gist here is: reacting to changes in real-time.</p>
<p>YugabyteDB is a horizontally scalable 100% open-source distributed SQL database providing Cassandra (YCQL) and PostgreSQL (YSQL) compatible APIs. For PostgreSQL API, YugabyteDB uses the actual PostgreSQL 11.2 engine. With just PostgreSQL, a company could use the <code>NOTIFY/SUBSCRIBE</code> functionality for reactivity within the database, and a CDC solution like <em>Debezium</em> for outside-of-the-database integration.</p>
<p>YugabyteDB currently does not support <code>NOTIFY/SUBSCRIBE</code> but it comes with built-in support for CDC. CDC operates on a lower level than said PostgreSQL functionality, but it&rsquo;s a very good foundation to build a general purpose <code>NOTIFY/SUBSCRIBE</code> alternative. The downside is, the data will always leave the cluster in order to be processed.</p>
<h2 id="commercial-plug"><a href="#commercial-plug" class="anchor-link">Â§</a>commercial plug</h2>
<p>If your company is looking for someone who can help you migrate your database to the cloud, or your company needs a solid partner who knows a thing or two about YugabyteDâreach out to Radek at <a href="mailto:radek.gruchalski@klarrio.com">radek.gruchalski@klarrio.com</a>.</p>
<p>At Klarrio, we do all sorts of amazing stuff with all sorts of technologies. Bleeding edge, cloud, hybrid, but also boring and old school. We&rsquo;re not chasing the new shiny. The best tool for the job.</p>
<p>Get in touch to find out more.</p>
<h2 id="analysis-of-a-yugabytedb-cdc-client"><a href="#analysis-of-a-yugabytedb-cdc-client" class="anchor-link">Â§</a>analysis of a YugabyteDB CDC client</h2>
<p>I started my investigation by looking at the YugabyteDB CDC Java client - <em>yb-cdc</em>. The client is part of the YugabyteDB source code repository and <a href="https://github.com/yugabyte/yugabyte-db/tree/master/java/yb-cdc" target="_blank" rel="noopener">it can be found here</a><sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">[1]</a></sup>. The code footprint is pretty small so this makes it easier to identify required steps.</p>
<p>The Java client comes with six classes:</p>
<ul>
<li><code>org.yb.cdc.CmdLineOptions</code></li>
<li><code>org.yb.cdc.LogClient</code></li>
<li><code>org.yb.cdc.LogConnector</code></li>
<li><code>org.yb.cdc.Main</code></li>
<li><code>org.yb.cdc.OutputClient</code></li>
<li><code>org.yb.cdc.Poller</code></li>
</ul>
<p>We can safely ignore <code>CmdLineOptions</code>, <code>Main</code>, <code>LogClient</code>, and <code>OutputClient</code>, they&rsquo;re just a boilerplate to have a functional Java program. <code>OutputClient</code> is an interface a real Java program needs to implement to receive changes from the <code>Poller</code> instance. <code>LogClient</code> is a default implementation of the <code>OutputClient</code>. That leaves us with two classes having some significance.</p>
<p>The <code>LogConnector</code> class contains the YugabyteDB client and performs the setup of a CDC session. The <code>Poller</code> performs the data capture.</p>
<h2 id="the-connector"><a href="#the-connector" class="anchor-link">Â§</a>the connector</h2>
<p>Let&rsquo;s look at the <code>LogConnector</code>. There&rsquo;s only a constructor a <code>run()</code> method. The constructor does the following:</p>
<ul>
<li>Creates YugabyteDB async and sync clients (this is an implementation detail of how the Java client works).</li>
<li>Lists all tables:</li>
</ul>
<p>In the YugabyteDB RPC API world, this call returns all tables for all databases in a YugabyteDB cluster. To find out more about the YugabyteDB RPC API, <a href="https://gruchalski.com/posts/2022-02-12-a-brief-look-at-yugabytedb-rpc-api/" target="_blank" rel="noopener">read this article</a><sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">[2]</a></sup>.</p>
<p>The response is a <em>protobuf</em> <code>ListTablesRequestPB</code> message:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-proto" data-lang="proto"><span class="line"><span class="cl"><span class="kd">message</span> <span class="nc">ListTablesResponsePB</span> <span class="p">{</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="c1">// The error, if an error occurred with this request.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">optional</span> <span class="n">MasterErrorPB</span> <span class="n">error</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="kd">message</span> <span class="nc">TableInfo</span> <span class="p">{</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>    <span class="k">required</span> <span class="kt">bytes</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>    <span class="k">required</span> <span class="kt">string</span> <span class="n">name</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>    <span class="k">optional</span> <span class="n">TableType</span> <span class="n">table_type</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>    <span class="k">optional</span> <span class="n">NamespaceIdentifierPB</span> <span class="n">namespace</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>    <span class="k">optional</span> <span class="n">RelationType</span> <span class="n">relation_type</span> <span class="o">=</span> <span class="mi">5</span> <span class="p">[</span><span class="k">default</span> <span class="o">=</span> <span class="n">USER_TABLE_RELATION</span><span class="p">];</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>    <span class="k">optional</span> <span class="n">SysTablesEntryPB.State</span> <span class="n">state</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="p">}</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="k">repeated</span> <span class="n">TableInfo</span> <span class="n">tables</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="p">}</span><span class="err">
</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p>The <code>id</code> is a table ID, <code>name</code> is a table name, and the <code>NamespaceIdentifierPB namespace</code> contains the information about the database the table belongs to. The <code>NamespaceIdentifierPB</code> message looks like this:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-proto" data-lang="proto"><span class="line"><span class="cl"><span class="kd">message</span> <span class="nc">NamespaceIdentifierPB</span> <span class="p">{</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="c1">// The namespace ID to fetch info.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">optional</span> <span class="kt">bytes</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="c1">// The namespace name to fetch info.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">optional</span> <span class="kt">string</span> <span class="n">name</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="c1">// Database type.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">optional</span> <span class="n">YQLDatabase</span> <span class="n">database_type</span> <span class="o">=</span> <span class="mi">3</span> <span class="p">[</span> <span class="k">default</span> <span class="o">=</span> <span class="n">YQL_DATABASE_CQL</span> <span class="p">];</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="p">}</span><span class="err">
</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p>The <code>id</code> is the namespace ID, <code>name</code> is the database name and the <code>database_type</code> will hold the value of <code>YQL_DATABASE_PGSQL</code> for YSQL tables.</p>
<ul>
<li>Once all tables are listed, the <code>LogConnector</code> filters retrieved <em>table infos</em> for the required table indicated with the <code>table_name</code> command-line argument; this argument has the following form <code>&lt;keyspace&gt;.&lt;table-name&gt;</code>; the client splits the argument by a <code>.</code> and uses the pair to find the table internal table ID.</li>
<li>Lists cluster tablet servers.</li>
</ul>
<p>At this point in time, the <code>LogConnector</code> is connected and it verified that the table for which the CDC consumer is to be created, exists. Once <code>run()</code> is executed, the connector will:</p>
<ul>
<li>Check if the CDC stream ID is given, if not, it will create a CDC using the <code>CreateCDCStreamRequestPB</code> message defined in <code>master/master_replication.proto</code>.</li>
<li>Find all tablets for a table using the <code>GetTableLocationsRequestPB</code> defined in <code>master/master_client.proto</code>.</li>
<li>For each tablet, create a <code>Poller</code>.</li>
</ul>
<h2 id="the-poller"><a href="#the-poller" class="anchor-link">Â§</a>the poller</h2>
<p>The <code>Poller</code> class is a little bit more complex than the connector but what it does, is rather simple to understand. The work starts by calling the <code>poll()</code> method.</p>
<ul>
<li>Using a randomly selected TServer address, the poller sends the <code>GetChangesRequestPB</code> message to the master replication service.</li>
</ul>
<p>The message definition is in <code>cdc/cdc_service.proto</code>:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-proto" data-lang="proto"><span class="line"><span class="cl"><span class="kd">message</span> <span class="nc">GetChangesRequestPB</span> <span class="p">{</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="k">optional</span> <span class="kt">bytes</span> <span class="n">stream_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="c1">// Tablet to get the changes for.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">optional</span> <span class="kt">bytes</span> <span class="n">tablet_id</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="c1">// Checkpoint to start reading from (exclusive).
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// Start reading from the first record after this checkpoint.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">optional</span> <span class="n">CDCCheckpointPB</span> <span class="n">from_checkpoint</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="c1">// Maximum records to read.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">optional</span> <span class="kt">uint32</span> <span class="n">max_records</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="c1">// Whether the caller knows the tablet address or needs to use us as a proxy.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">optional</span> <span class="kt">bool</span> <span class="n">serve_as_proxy</span> <span class="o">=</span> <span class="mi">5</span> <span class="p">[</span><span class="k">default</span> <span class="o">=</span> <span class="kc">true</span><span class="p">];</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="p">}</span><span class="err">
</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p>The request requires a <code>stream_id</code>, a <code>tablet_id</code>, and the checkpoint metadata. The checkpoint metadata definition is:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-proto" data-lang="proto"><span class="line"><span class="cl"><span class="kd">message</span> <span class="nc">CDCCheckpointPB</span> <span class="p">{</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="k">optional</span> <span class="n">OpIdPB</span> <span class="n">op_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="p">}</span><span class="err">
</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p>where <code>op_id</code> is defined in <code>util/opid.proto</code>:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-proto" data-lang="proto"><span class="line"><span class="cl"><span class="kd">message</span> <span class="nc">OpIdPB</span> <span class="p">{</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="c1">// The term of an operation or the leader&#39;s sequence id.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">required</span> <span class="kt">int64</span> <span class="n">term</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="k">required</span> <span class="kt">int64</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="p">}</span><span class="err">
</span></span></span></code></pre></td></tr></table></div>
</div>
</div><ul>
<li>Once the response arrives, the response data propagates to the <code>Void doHandlePoll(GetChangesResponse getChangesResponse)</code> method.</li>
<li>The <code>doHandlePoll</code> processes individual records from the response, updates the <code>Poller</code> internal <code>term</code> and <code>index</code>, and executes <code>poll()</code> once again.</li>
</ul>
<p>Thus, the <code>Poller</code> continuously polls for new data and each tablet has its own <code>Poller</code> instance.</p>
<h2 id="building-a-cdc-solution-from-scratch"><a href="#building-a-cdc-solution-from-scratch" class="anchor-link">Â§</a>building a CDC solution from scratch</h2>
<p>To verify the knowledge, I am going to build a very simple CDC client. Instead of Java, I used Go with the <a href="https://gruchalski.com/posts/2022-02-16-yugabytedb-go-rpc-client/" target="_blank" rel="noopener">Go RPC client</a><sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">[3]</a></sup>.</p>
<p>You can find the <a href="https://github.com/radekg/yugabyte-db-cdctest" target="_blank" rel="noopener">CDC client here</a><sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">[4]</a></sup>.</p>
<h3 id="the-yugabytedb-cluster"><a href="#the-yugabytedb-cluster" class="anchor-link">Â§</a>the YugabyteDB cluster</h3>
<p>To be able to test the solution, I need a YugabyteDB cluster with some data in it. I&rsquo;m going to use the <a href="https://github.com/radekg/yugabyte-db-multi-tenant-paas-demo" target="_blank" rel="noopener">YugabyteDB multi-tenant PaaS demo</a><sup id="fnref:5"><a href="#fn:5" class="footnote-ref" role="doc-noteref">[5]</a></sup>, which I&rsquo;ve created a while ago.</p>
<p>My environment looks like this:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">$ docker-compose -v
</span></span><span class="line"><span class="cl">Docker Compose version v2.2.3
</span></span><span class="line"><span class="cl">$ docker -v
</span></span><span class="line"><span class="cl">Docker version 20.10.12, build e91ed57
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>On Linux, Docker Compose needs to be installed separate from Docker. Instructions <a href="https://docs.docker.com/compose/install/#install-compose-on-linux-systems" target="_blank" rel="noopener">here</a><sup id="fnref:6"><a href="#fn:6" class="footnote-ref" role="doc-noteref">[6]</a></sup>.</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="nb">cd</span> /tmp
</span></span><span class="line"><span class="cl">git clone https://github.com/radekg/yugabyte-db-multi-tenant-paas-demo.git
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> yugabyte-db-multi-tenant-paas-demo
</span></span><span class="line"><span class="cl"><span class="c1"># build the Docker image used by the infrastructure</span>
</span></span><span class="line"><span class="cl">make docker-image-upstream
</span></span><span class="line"><span class="cl"><span class="c1"># point to an env file</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">DC_ENV_FILE</span><span class="o">=</span>.env
</span></span><span class="line"><span class="cl"><span class="c1"># start the cluster</span>
</span></span><span class="line"><span class="cl">docker compose --env-file <span class="s2">&#34;</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span><span class="s2">/</span><span class="si">${</span><span class="nv">DC_ENV_FILE</span><span class="si">}</span><span class="s2">&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -f compose-masters.yml <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -f compose-tservers-shared.yml up
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>This will take a few seconds to settle. There will be:</p>
<ul>
<li>three master servers,</li>
<li>three TServers,</li>
<li>an Envoy proxy in front of TServers.</li>
</ul>
<p>Let&rsquo;s verify that everything is working. In another terminal:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">docker <span class="nb">exec</span> -ti yb-master-n1 /bin/bash -c <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="s1">&#39;yb-admin -master_addresses yb-master-n1:7100,yb-master-n2:7100,yb-master-n3:7100 list_all_masters&#39;</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>should produce something similar to:</p>
<pre tabindex="0"><code>Master UUID                      	RPC Host/Port        	State    	Role
44dec826f77148929c12e4afd2ead389 	yb-master-n1:7100    	ALIVE    	FOLLOWER
b8db32a7f9f549c2bdbd824a07d173fb 	yb-master-n2:7100    	ALIVE    	LEADER
1f549268a41f4759ab821042f3f2490c 	yb-master-n3:7100    	ALIVE    	FOLLOWER
</code></pre><p>Your UUIDs will be different and your cluster may have a different leader. Let&rsquo;s look at our TServers, again, TServer UUIDs will be different:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">docker <span class="nb">exec</span> -ti yb-master-n1 /bin/bash -c <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="s1">&#39;yb-admin -master_addresses yb-master-n1:7100,yb-master-n2:7100,yb-master-n3:7100 list_all_tablet_servers&#39;</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><pre tabindex="0"><code>Tablet Server UUID               RPC Host/Port Heartbeat delay Status   Reads/s  Writes/s Uptime   SST total size  SST uncomp size SST #files      Memory
ce5dbc4bdc574b33b52313f0ea8bf89d yb-tserver-shared-2:9100 0.43s           ALIVE    0.00     0.00     157      0 B             0 B             0               45.09 MB
49e47380d5cc4e53b8991d5f4034b596 yb-tserver-shared-1:9100 0.43s           ALIVE    0.00     0.00     157      0 B             0 B             0               45.09 MB
e313e4dd6cd1410189fa73562a47fba4 yb-tserver-shared-3:9100 0.43s           ALIVE    0.00     0.00     158      0 B             0 B             0               44.04 MB
</code></pre><h3 id="load-the-data-into-the-cluster"><a href="#load-the-data-into-the-cluster" class="anchor-link">Â§</a>load the data into the cluster</h3>
<p>To connect via YSQL connection, you will have to connect via Envoy. Docker Compose exposes Envoy to your host on port <code>35432</code>. We can try this with:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">psql <span class="s2">&#34;host=localhost port=35432 user=yugabyte dbname=yugabyte&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -c <span class="s2">&#34;select table_name from information_schema.tables limit 1&#34;</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><p><em>The password is <code>yugabyte</code></em>.</p>
<p>The output is:</p>
<pre tabindex="0"><code>   table_name
----------------
 pg_default_acl
(1 row)
</code></pre><p>Let&rsquo;s create a database and load the data:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">psql <span class="s2">&#34;host=localhost port=35432 user=yugabyte dbname=yugabyte&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -c <span class="s2">&#34;create database cdctest&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># the database name changes here:</span>
</span></span><span class="line"><span class="cl">psql <span class="s2">&#34;host=localhost port=35432 user=yugabyte dbname=cdctest&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -f sql-init-northwind-tenant1.sql
</span></span><span class="line"><span class="cl">psql <span class="s2">&#34;host=localhost port=35432 user=yugabyte dbname=cdctest&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -f sql-init-northwind-data-tenant1.sql
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>Don&rsquo;t worry about the <em>tenant1</em> suffix. It doesn&rsquo;t matter. Let&rsquo;s check what tables do we have in our database:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">psql <span class="s2">&#34;host=localhost port=35432 user=yugabyte dbname=cdctest&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -c <span class="s2">&#34;select table_name from information_schema.tables where table_schema=&#39;public&#39;&#34;</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><pre tabindex="0"><code>       table_name
------------------------
 categories
 customer_demographics
 customers
 customer_customer_demo
 employees
 suppliers
 products
 region
 shippers
 orders
 territories
 employee_territories
 order_details
 us_states
(14 rows)
</code></pre><div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">psql <span class="s2">&#34;host=localhost port=35432 user=yugabyte dbname=cdctest&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -c <span class="s2">&#34;select count(*) from customers&#34;</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><pre tabindex="0"><code> count
-------
    91
(1 row)
</code></pre><p>The database is initialized and ready to work with.</p>
<h3 id="run-the-minimal-client"><a href="#run-the-minimal-client" class="anchor-link">Â§</a>run the minimal client</h3>
<p>Time to build and run the minimal CDC client:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="nb">cd</span> /tmp
</span></span><span class="line"><span class="cl">git clone https://github.com/radekg/yugabyte-db-cdctest.git
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> yugabyte-db-cdctest/
</span></span><span class="line"><span class="cl">docker build -t local/yugabyte-db-cdctest:latest .
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>and run it against the cluster:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">docker run --net<span class="o">=</span>yb-dbnet --rm <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -ti local/yugabyte-db-cdctest:latest <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --database<span class="o">=</span>cdctest <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --table<span class="o">=</span>region <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --masters<span class="o">=</span>yb-master-n1:7100,yb-master-n2:7100,yb-master-n3:7100
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>After a short moment, the CDC data should start streaming to the terminal. This initial output is the data inserted into the database during the initial import.</p>
<p><strong>Note:</strong> the network used by the cluster is called <code>yb-dbnet</code> and that&rsquo;s the network we run the CDC container in.</p>
<h2 id="cdc-payloads"><a href="#cdc-payloads" class="anchor-link">Â§</a>CDC payloads</h2>
<p>Let&rsquo;s ignore the initial data streamed to us and focus on subsequent changes. While the cluster and the CDC client are running, execute the following query:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">psql <span class="s2">&#34;host=localhost port=35432 user=yugabyte dbname=cdctest&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -c <span class="s2">&#34;insert into region values (5, &#39;test&#39;)&#34;</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>The CDC program is going to output a JSON object similar to:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;records&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;time&#34;</span><span class="p">:</span> <span class="mi">6740254233675632640</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;operation&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;key&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;key&#34;</span><span class="p">:</span> <span class="s2">&#34;cmVnaW9uX2lk&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;value&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;Value&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="nt">&#34;Int16Value&#34;</span><span class="p">:</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;changes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;key&#34;</span><span class="p">:</span> <span class="s2">&#34;cmVnaW9uX2Rlc2NyaXB0aW9u&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;value&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;Value&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="nt">&#34;StringValue&#34;</span><span class="p">:</span> <span class="s2">&#34;dGVzdA==&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;transaction_state&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;transaction_id&#34;</span><span class="p">:</span> <span class="s2">&#34;5f3eR+OKSbWaOYDWE+FRIQ==&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;tablets&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;MzczZDRmM2E5N2JhNDk5Mzk1ZWI5NzRlNWQyOGM3NGU=&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;time&#34;</span><span class="p">:</span> <span class="mi">6740254233712037888</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;operation&#34;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;transaction_state&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;transaction_id&#34;</span><span class="p">:</span> <span class="s2">&#34;5f3eR+OKSbWaOYDWE+FRIQ==&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;commit_hybrid_time&#34;</span><span class="p">:</span> <span class="mi">6740254233699799040</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;partition&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;partition_key_start&#34;</span><span class="p">:</span> <span class="s2">&#34;VVU=&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;partition_key_end&#34;</span><span class="p">:</span> <span class="s2">&#34;qqo=&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;checkpoint&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;op_id&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;term&#34;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;index&#34;</span><span class="p">:</span> <span class="mi">61</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>There&rsquo;s going to be one JSON object per each individual tablet. What can we infer from this data?</p>
<ul>
<li><code>records.*.operation</code> is the operation type, one of:</li>
</ul>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-proto" data-lang="proto"><span class="line"><span class="cl"><span class="n">type</span> <span class="n">CDCRecordPB_OperationType</span> <span class="kt">int32</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="n">const</span> <span class="p">(</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>	<span class="n">CDCRecordPB_WRITE</span>  <span class="n">CDCRecordPB_OperationType</span> <span class="o">=</span> <span class="mi">1</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>	<span class="n">CDCRecordPB_DELETE</span> <span class="n">CDCRecordPB_OperationType</span> <span class="o">=</span> <span class="mi">2</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>	<span class="n">CDCRecordPB_APPLY</span>  <span class="n">CDCRecordPB_OperationType</span> <span class="o">=</span> <span class="mi">3</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="p">)</span><span class="err">
</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p>In this case, the operation was <code>write</code> followed by an <code>apply</code>.</p>
<ul>
<li><code>records.*.key</code> contains the row key for which the write happened, that&rsquo;s where we can find our <code>5</code>, the <code>cmVnaW9uX2lk</code> is a base64 encoded <code>region_id</code>; the <code>key</code> is an array of objects, which suggests that there may be multiple entries when the table has a composite key,</li>
<li><code>records.*.changes</code> is an array of objects with a <code>key</code> and a <code>value</code>,
<ul>
<li>the <code>key</code> of each change, is the colume name, if we base64 decode the <code>cmVnaW9uX2Rlc2NyaXB0aW9u</code> value, we get <code>region_description</code>, which is the column name where the textual value goes,</li>
<li>the <code>value</code> of each individual change contains a typed value for the column, this is probably where the largest chunk of processing would go in a real application (do discover the value type, it could probably be correlated by loading the table schema beforehand <code>GetTableSchemaRequestPB</code> message defined in <code>master/master_ddl.proto</code>), in our case, the base64 decoded <code>dGVzdA==</code> is <code>test</code> - exactly what we have inserted,</li>
</ul>
</li>
<li>the complete changeset contains the partition information; combined with the tablet ID of each individual change, it would be possible to react only to the changes happening within a specific geographical location; <a href="https://blog.yugabyte.com/geo-partitioning-of-data-in-yugabytedb/" target="_blank" rel="noopener">find out more</a><sup id="fnref:7"><a href="#fn:7" class="footnote-ref" role="doc-noteref">[7]</a></sup>.</li>
</ul>
<p>Okay, let&rsquo;s see what happens when we issue an update:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">psql <span class="s2">&#34;host=localhost port=35432 user=yugabyte dbname=cdctest&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -c <span class="s2">&#34;update region set region_description=&#39;new value&#39; where region_id=5&#34;</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>Results in JSON similar to:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;records&#34;</span>:<span class="o">[</span>
</span></span><span class="line"><span class="cl">      <span class="o">{</span>
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;time&#34;</span>:6740254233675632640,
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;operation&#34;</span>:1,
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;key&#34;</span>:<span class="o">[</span>
</span></span><span class="line"><span class="cl">            <span class="o">{</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;key&#34;</span>:<span class="s2">&#34;cmVnaW9uX2lk&#34;</span>,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;value&#34;</span>:<span class="o">{</span>
</span></span><span class="line"><span class="cl">                  <span class="s2">&#34;Value&#34;</span>:<span class="o">{</span>
</span></span><span class="line"><span class="cl">                     <span class="s2">&#34;Int16Value&#34;</span>:5
</span></span><span class="line"><span class="cl">                  <span class="o">}</span>
</span></span><span class="line"><span class="cl">               <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">         <span class="o">]</span>,
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;changes&#34;</span>:<span class="o">[</span>
</span></span><span class="line"><span class="cl">            <span class="o">{</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;key&#34;</span>:<span class="s2">&#34;cmVnaW9uX2Rlc2NyaXB0aW9u&#34;</span>,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;value&#34;</span>:<span class="o">{</span>
</span></span><span class="line"><span class="cl">                  <span class="s2">&#34;Value&#34;</span>:<span class="o">{</span>
</span></span><span class="line"><span class="cl">                     <span class="s2">&#34;StringValue&#34;</span>:<span class="s2">&#34;dGVzdA==&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="o">}</span>
</span></span><span class="line"><span class="cl">               <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">         <span class="o">]</span>,
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;transaction_state&#34;</span>:<span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;transaction_id&#34;</span>:<span class="s2">&#34;5f3eR+OKSbWaOYDWE+FRIQ==&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;tablets&#34;</span>:<span class="o">[</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;MzczZDRmM2E5N2JhNDk5Mzk1ZWI5NzRlNWQyOGM3NGU=&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">]</span>
</span></span><span class="line"><span class="cl">         <span class="o">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">}</span>,
</span></span><span class="line"><span class="cl">      <span class="o">{</span>
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;time&#34;</span>:6740254233712037888,
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;operation&#34;</span>:3,
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;transaction_state&#34;</span>:<span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;transaction_id&#34;</span>:<span class="s2">&#34;5f3eR+OKSbWaOYDWE+FRIQ==&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;commit_hybrid_time&#34;</span>:6740254233699799040
</span></span><span class="line"><span class="cl">         <span class="o">}</span>,
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;partition&#34;</span>:<span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;partition_key_start&#34;</span>:<span class="s2">&#34;VVU=&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;partition_key_end&#34;</span>:<span class="s2">&#34;qqo=&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="o">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">}</span>,
</span></span><span class="line"><span class="cl">      <span class="o">{</span>
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;time&#34;</span>:6740257126013730816,
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;operation&#34;</span>:1,
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;key&#34;</span>:<span class="o">[</span>
</span></span><span class="line"><span class="cl">            <span class="o">{</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;key&#34;</span>:<span class="s2">&#34;cmVnaW9uX2lk&#34;</span>,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;value&#34;</span>:<span class="o">{</span>
</span></span><span class="line"><span class="cl">                  <span class="s2">&#34;Value&#34;</span>:<span class="o">{</span>
</span></span><span class="line"><span class="cl">                     <span class="s2">&#34;Int16Value&#34;</span>:5
</span></span><span class="line"><span class="cl">                  <span class="o">}</span>
</span></span><span class="line"><span class="cl">               <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">         <span class="o">]</span>,
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;changes&#34;</span>:<span class="o">[</span>
</span></span><span class="line"><span class="cl">            <span class="o">{</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;key&#34;</span>:<span class="s2">&#34;cmVnaW9uX2Rlc2NyaXB0aW9u&#34;</span>,
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;value&#34;</span>:<span class="o">{</span>
</span></span><span class="line"><span class="cl">                  <span class="s2">&#34;Value&#34;</span>:<span class="o">{</span>
</span></span><span class="line"><span class="cl">                     <span class="s2">&#34;StringValue&#34;</span>:<span class="s2">&#34;bmV3IHZhbHVl&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="o">}</span>
</span></span><span class="line"><span class="cl">               <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">         <span class="o">]</span>,
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;transaction_state&#34;</span>:<span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;transaction_id&#34;</span>:<span class="s2">&#34;B7Ewh2S6RmW7T9R0kx/JSw==&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;tablets&#34;</span>:<span class="o">[</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;MzczZDRmM2E5N2JhNDk5Mzk1ZWI5NzRlNWQyOGM3NGU=&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">]</span>
</span></span><span class="line"><span class="cl">         <span class="o">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">}</span>,
</span></span><span class="line"><span class="cl">      <span class="o">{</span>
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;time&#34;</span>:6740257126053367808,
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;operation&#34;</span>:3,
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;transaction_state&#34;</span>:<span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;transaction_id&#34;</span>:<span class="s2">&#34;B7Ewh2S6RmW7T9R0kx/JSw==&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;commit_hybrid_time&#34;</span>:6740257126043394048
</span></span><span class="line"><span class="cl">         <span class="o">}</span>,
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;partition&#34;</span>:<span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;partition_key_start&#34;</span>:<span class="s2">&#34;VVU=&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;partition_key_end&#34;</span>:<span class="s2">&#34;qqo=&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="o">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">}</span>
</span></span><span class="line"><span class="cl">   <span class="o">]</span>,
</span></span><span class="line"><span class="cl">   <span class="s2">&#34;checkpoint&#34;</span>:<span class="o">{</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;op_id&#34;</span>:<span class="o">{</span>
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;term&#34;</span>:2,
</span></span><span class="line"><span class="cl">         <span class="s2">&#34;index&#34;</span>:63
</span></span><span class="line"><span class="cl">      <span class="o">}</span>
</span></span><span class="line"><span class="cl">   <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>Again, one object per tablet. This time we have four records. A <code>write</code>, <code>apply</code>, <code>write</code>, and <code>apply</code> again. We can see that our new value is returned here, the <code>bmV3IHZhbHVl</code> is a base64 encoded <code>new value</code> string.</p>
<p>Also, it seems that for each column, we get a full log of subsequent changes! That&rsquo;s pretty cool.</p>
<p>Let&rsquo;s try a delete:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">psql <span class="s2">&#34;host=localhost port=35432 user=yugabyte dbname=cdctest&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -c <span class="s2">&#34;delete from region where region_id=5&#34;</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>Which will output the following, for each tablet:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;records&#34;</span><span class="p">:[</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;time&#34;</span><span class="p">:</span><span class="mi">6740254233675632640</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;operation&#34;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;key&#34;</span><span class="p">:[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;key&#34;</span><span class="p">:</span><span class="s2">&#34;cmVnaW9uX2lk&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;value&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;Value&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;Int16Value&#34;</span><span class="p">:</span><span class="mi">5</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">               <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">],</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;changes&#34;</span><span class="p">:[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;key&#34;</span><span class="p">:</span><span class="s2">&#34;cmVnaW9uX2Rlc2NyaXB0aW9u&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;value&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;Value&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;StringValue&#34;</span><span class="p">:</span><span class="s2">&#34;dGVzdA==&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">               <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">],</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;transaction_state&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;transaction_id&#34;</span><span class="p">:</span><span class="s2">&#34;5f3eR+OKSbWaOYDWE+FRIQ==&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;tablets&#34;</span><span class="p">:[</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;MzczZDRmM2E5N2JhNDk5Mzk1ZWI5NzRlNWQyOGM3NGU=&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;time&#34;</span><span class="p">:</span><span class="mi">6740254233712037888</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;operation&#34;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;transaction_state&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;transaction_id&#34;</span><span class="p">:</span><span class="s2">&#34;5f3eR+OKSbWaOYDWE+FRIQ==&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;commit_hybrid_time&#34;</span><span class="p">:</span><span class="mi">6740254233699799040</span>
</span></span><span class="line"><span class="cl">         <span class="p">},</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;partition&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;partition_key_start&#34;</span><span class="p">:</span><span class="s2">&#34;VVU=&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;partition_key_end&#34;</span><span class="p">:</span><span class="s2">&#34;qqo=&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;time&#34;</span><span class="p">:</span><span class="mi">6740257126013730816</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;operation&#34;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;key&#34;</span><span class="p">:[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;key&#34;</span><span class="p">:</span><span class="s2">&#34;cmVnaW9uX2lk&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;value&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;Value&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;Int16Value&#34;</span><span class="p">:</span><span class="mi">5</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">               <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">],</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;changes&#34;</span><span class="p">:[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;key&#34;</span><span class="p">:</span><span class="s2">&#34;cmVnaW9uX2Rlc2NyaXB0aW9u&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;value&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;Value&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;StringValue&#34;</span><span class="p">:</span><span class="s2">&#34;bmV3IHZhbHVl&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">               <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">],</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;transaction_state&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;transaction_id&#34;</span><span class="p">:</span><span class="s2">&#34;B7Ewh2S6RmW7T9R0kx/JSw==&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;tablets&#34;</span><span class="p">:[</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;MzczZDRmM2E5N2JhNDk5Mzk1ZWI5NzRlNWQyOGM3NGU=&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;time&#34;</span><span class="p">:</span><span class="mi">6740257126053367808</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;operation&#34;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;transaction_state&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;transaction_id&#34;</span><span class="p">:</span><span class="s2">&#34;B7Ewh2S6RmW7T9R0kx/JSw==&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;commit_hybrid_time&#34;</span><span class="p">:</span><span class="mi">6740257126043394048</span>
</span></span><span class="line"><span class="cl">         <span class="p">},</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;partition&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;partition_key_start&#34;</span><span class="p">:</span><span class="s2">&#34;VVU=&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;partition_key_end&#34;</span><span class="p">:</span><span class="s2">&#34;qqo=&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;time&#34;</span><span class="p">:</span><span class="mi">6740259770935541760</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;operation&#34;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;key&#34;</span><span class="p">:[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;key&#34;</span><span class="p">:</span><span class="s2">&#34;cmVnaW9uX2lk&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;value&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">                  <span class="nt">&#34;Value&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">                     <span class="nt">&#34;Int16Value&#34;</span><span class="p">:</span><span class="mi">5</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">               <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">],</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;transaction_state&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;transaction_id&#34;</span><span class="p">:</span><span class="s2">&#34;w/OzDpk5TQSZrSOR2lz6yg==&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;tablets&#34;</span><span class="p">:[</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;MzczZDRmM2E5N2JhNDk5Mzk1ZWI5NzRlNWQyOGM3NGU=&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;time&#34;</span><span class="p">:</span><span class="mi">6740259771120664576</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;operation&#34;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;transaction_state&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;transaction_id&#34;</span><span class="p">:</span><span class="s2">&#34;w/OzDpk5TQSZrSOR2lz6yg==&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;commit_hybrid_time&#34;</span><span class="p">:</span><span class="mi">6740259771113287680</span>
</span></span><span class="line"><span class="cl">         <span class="p">},</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;partition&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;partition_key_start&#34;</span><span class="p">:</span><span class="s2">&#34;VVU=&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;partition_key_end&#34;</span><span class="p">:</span><span class="s2">&#34;qqo=&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">],</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;checkpoint&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;op_id&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;term&#34;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;index&#34;</span><span class="p">:</span><span class="mi">65</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>The delete resulted in six rows. So clearly the history of changes for each <code>key</code> is persisted. The two new operation types are <code>2</code> and <code>3</code>: <code>delete</code> and <code>apply</code> respectively.</p>
<p>What&rsquo;s Looking at the <em>protobuf</em> object reveals more interesting detail:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-proto" data-lang="proto"><span class="line"><span class="cl"><span class="kd">message</span> <span class="nc">CDCRecordPB</span> <span class="p">{</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="kd">enum</span> <span class="n">OperationType</span> <span class="p">{</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>    <span class="n">WRITE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>    <span class="n">DELETE</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>    <span class="n">APPLY</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>    <span class="n">SPLIT_OP</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="p">}</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="k">optional</span> <span class="kt">uint64</span> <span class="n">time</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="k">optional</span> <span class="n">OperationType</span> <span class="n">operation</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="c1">// Primary key of the record that changed
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">repeated</span> <span class="n">KeyValuePairPB</span> <span class="n">key</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="c1">// Key-value pairs (column_name : value) of changes / before record / after record
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">repeated</span> <span class="n">KeyValuePairPB</span> <span class="n">changes</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="k">repeated</span> <span class="n">KeyValuePairPB</span> <span class="n">before</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>  <span class="c1">// NOT CURRENTLY USED
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">repeated</span> <span class="n">KeyValuePairPB</span> <span class="n">after</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>   <span class="c1">// NOT CURRENTLY USED
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="k">optional</span> <span class="n">tablet.TransactionStatePB</span> <span class="n">transaction_state</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="c1">// If transaction_state.status is APPLYING, then partitions will contain the partition for the
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// tablet being polled.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">optional</span> <span class="n">PartitionPB</span> <span class="n">partition</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>  <span class="c1">// If operation type is a SPLIT_OP, then include the split request.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">optional</span> <span class="n">tablet.SplitTabletRequestPB</span> <span class="n">split_tablet_request</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="p">}</span><span class="err">
</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p>It seems like we may be getting more insight into what we had before the change and what we have after the change - <code>before</code>, <code>after</code>, and <code>changes</code> fields. However, as the comments say, it&rsquo;s not supported yet.</p>
<h2 id="its-powerful"><a href="#its-powerful" class="anchor-link">Â§</a>it&rsquo;s powerful</h2>
<p>Very straightforward to approach and a great foundation for integrating distributed SQL with real-time pipelines. CDC data can be easily ingested and transformed with Kafka or another data streaming solution to power all sorts of business applications inside of an enterprise.</p>
<p>Having an out-of-the-box possibility to fuse distributed SQL and real-time streaming data is a superpower with unlimited applications in today&rsquo;s data-driven world.</p>
<p>That&rsquo;s it for today, dipping the toes in YugabyteDB CDC.</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><a href="https://github.com/yugabyte/yugabyte-db/tree/master/java/yb-cdc" target="_blank" rel="noopener">YugabyteDB CDC Java client</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" class="icon footnote-icon"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6 0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9 0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9 0L7 329.7c-9.4-9.4-9.4-24.6 0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg></a></p>
</li>
<li id="fn:2">
<p><a href="https://gruchalski.com/posts/2022-02-12-a-brief-look-at-yugabytedb-rpc-api/" target="_blank" rel="noopener">A brief look at YugabyteDB RPC API</a>&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" class="icon footnote-icon"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6 0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9 0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9 0L7 329.7c-9.4-9.4-9.4-24.6 0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg></a></p>
</li>
<li id="fn:3">
<p><a href="https://gruchalski.com/posts/2022-02-16-yugabytedb-go-rpc-client/" target="_blank" rel="noopener">YugabyteDB Go RPC client</a>&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" class="icon footnote-icon"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6 0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9 0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9 0L7 329.7c-9.4-9.4-9.4-24.6 0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg></a></p>
</li>
<li id="fn:4">
<p><a href="https://github.com/radekg/yugabyte-db-cdctest" target="_blank" rel="noopener">YugabyteDB CDC demo client</a>&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" class="icon footnote-icon"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6 0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9 0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9 0L7 329.7c-9.4-9.4-9.4-24.6 0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg></a></p>
</li>
<li id="fn:5">
<p><a href="https://github.com/radekg/yugabyte-db-multi-tenant-paas-demo" target="_blank" rel="noopener">YugabyteDB multi-tenant PaaS demo</a>&#160;<a href="#fnref:5" class="footnote-backref" role="doc-backlink"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" class="icon footnote-icon"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6 0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9 0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9 0L7 329.7c-9.4-9.4-9.4-24.6 0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg></a></p>
</li>
<li id="fn:6">
<p><a href="https://docs.docker.com/compose/install/#install-compose-on-linux-systems" target="_blank" rel="noopener">Install Compose on Linux systems</a>&#160;<a href="#fnref:6" class="footnote-backref" role="doc-backlink"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" class="icon footnote-icon"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6 0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9 0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9 0L7 329.7c-9.4-9.4-9.4-24.6 0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg></a></p>
</li>
<li id="fn:7">
<p><a href="https://blog.yugabyte.com/geo-partitioning-of-data-in-yugabytedb/" target="_blank" rel="noopener">Geo-Partitioning of Data in YugabyteDB</a>&#160;<a href="#fnref:7" class="footnote-backref" role="doc-backlink"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" class="icon footnote-icon"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6 0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9 0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9 0L7 329.7c-9.4-9.4-9.4-24.6 0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg></a></p>
</li>
</ol>
</div>

            </div>

            <div class="subscribe-container">

    <h2 class="subscribe">Never miss a post</h2>
    <p class="subscribe">Interested in similar content? Get it right into your mailbox. <strong>Sign up now.</strong></p>

    <div class="inner">
        <form action="https://gruchalski.us1.list-manage.com/subscribe/post?u=7cc31051b7ae9b4636244cbb2&amp;id=80eb233246"
            method="post" name="mc-embedded-subscribe-form" target="_blank" novalidate>
            
            <div class="away" aria-hidden="true"><input type="text" name="b_7cc31051b7ae9b4636244cbb2_80eb233246" tabindex="-1" value=""></div>
            <div class="form-fields">
                <input type="email" value="" name="EMAIL" placeholder="email address" />
                <input type="submit" value="Subscribe" name="subscribe" />
            </div>
        </form>
    </div>

</div>
            
    
    
        <ul class="post-copyright">
            <li class="copyright-item author"><span class="copyright-item-text">Author</span>: <a href="https://io-oi.me/" class="p-author h-card" target="_blank" rel="noopener">radek gruchalski</a></li>
            
                
                
                
                
                <li class="copyright-item link"><span class="copyright-item-text">Link</span>: <a href="/posts/2022-02-23-yugabytedb-change-data-capture/" target="_blank" rel="noopener">https://gruchalski.com/posts/2022-02-23-yugabytedb-change-data-capture/</a></li>
            
            <li class="copyright-item license"><span class="copyright-item-text">License</span>: <a href="https://en.wikipedia.org/wiki/Canonical_link_element" target="_blank" rel="noopener">reposting requires attribution, <strong>use canonical links</strong> Â»</a></li>
            
        </ul>
    



        </article>

        

        


        


        <div class="post-share">

        

        <div class="share-items">

            
                <div class="share-item twitter">
                    
                    <a href="https://twitter.com/share?url=https://gruchalski.com/posts/2022-02-23-yugabytedb-change-data-capture/&amp;text=YugabyteDB%20change%20data%20capture&amp;hashtags=yugabytedb,cdc,&amp;via=%25!s%28%3cnil%3e%29" title="Share on Twitter" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon twitter-icon"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></a>
                </div>
            

            

            
                <div class="share-item linkedin">
                    
                    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://gruchalski.com/posts/2022-02-23-yugabytedb-change-data-capture/&amp;title=YugabyteDB%20change%20data%20capture&amp;summary=real-time%20systems%20&#43;%20distributed%20SQL&amp;source=gruchalski.com" title="Share on LinkedIn" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon linkedin-icon"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg></a>
                </div>
            

            

            

            

            

            

            
                <div class="share-item qrcode">
                    <div class="qrcode-container" title="Share via QR Code"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon qrcode-icon"><path d="M0 224h192V32H0v192zM64 96h64v64H64V96zm192-64v192h192V32H256zm128 128h-64V96h64v64zM0 480h192V288H0v192zm64-128h64v64H64v-64zm352-64h32v128h-96v-32h-32v96h-64V288h96v32h64v-32zm0 160h32v32h-32v-32zm-64 0h32v32h-32v-32z"/></svg><div id="qrcode-img"></div>
                    </div>
                    <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js"></script>

<script>
    var typeNumber = 0;
    var errorCorrectionLevel = 'L';
    var qr = qrcode(typeNumber, errorCorrectionLevel);
    qr.addData('https:\/\/gruchalski.com\/posts\/2022-02-23-yugabytedb-change-data-capture\/');
    qr.make();
    document.getElementById('qrcode-img').innerHTML = qr.createImgTag();
</script>

                </div>
            

        </div>

    </div>




        
    
    
        <div class="related-posts">
            <h2 class="related-title">See Also:<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon related-icon"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"/></svg></h2>
            <ul class="related-list">
                
                    <li class="related-item">
                        <a href="/posts/2022-03-19-yugabytedb-cdc-sdk-beta-a-high-level-overview/" class="related-link">YugabyteDB CDC SDK beta, a high level overview</a>
                    </li>
                
                    <li class="related-item">
                        <a href="/posts/2022-02-21-identifying-postgres-features-unsupported-in-yugabytedb/" class="related-link">Identifying Postgres features unsupported in YugabyteDB</a>
                    </li>
                
                    <li class="related-item">
                        <a href="/posts/2022-02-16-yugabytedb-go-rpc-client/" class="related-link">YugabyteDB Go RPC client</a>
                    </li>
                
                    <li class="related-item">
                        <a href="/posts/2022-02-12-a-brief-look-at-yugabytedb-rpc-api/" class="related-link">A brief look at YugabyteDB RPC API</a>
                    </li>
                
                    <li class="related-item">
                        <a href="/posts/2021-11-11-yugabytedb-the-book/" class="related-link">YugabyteDB: the book</a>
                    </li>
                
            </ul>
        </div>
    



        
    
        <div class="post-tags">
            
                
                
                
                
                    
                    <a href="/tags/yugabytedb/" rel="tag" class="post-tags-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon tag-icon"><path d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg>yugabytedb</a>
                
            
                
                
                
                
                    
                    <a href="/tags/cdc/" rel="tag" class="post-tags-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon tag-icon"><path d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg>cdc</a>
                
            
        </div>
    



        


        


        
    
        
        
    
    
    
    
        <ul class="post-nav">
            
                <li class="post-nav-prev">
                    <a href="/posts/2022-03-19-yugabytedb-cdc-sdk-beta-a-high-level-overview/" rel="prev">&lt; YugabyteDB CDC SDK beta, a high level overview</a>
                </li>
            
            
                <li class="post-nav-next">
                    <a href="/posts/2022-02-21-identifying-postgres-features-unsupported-in-yugabytedb/" rel="next">Identifying Postgres features unsupported in YugabyteDB &gt;</a>
                </li>
            
        </ul>
    



        


    </div>
</main>


            
    <div id="back-to-top" class="back-to-top">
        <a href="#"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon arrow-up"><path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6 0-33.9L207 39c9.4-9.4 24.6-9.4 33.9 0l194.3 194.3c9.4 9.4 9.4 24.6 0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3 0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"/></svg></a>
    </div>


            
    <footer id="footer" class="footer">
        <div class="footer-inner">
            <div class="site-info">Â©&nbsp;2015â2022&nbsp;<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon footer-icon"><path d="M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3 0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"/></svg>&nbsp;radek gruchalski</div><div class="powered-by">Powered by <a href="https://github.com/gohugoio/hugo" target="_blank" rel="noopener">Hugo</a> | Theme is <a href="https://github.com/reuixiy/hugo-theme-meme" target="_blank" rel="noopener">MemE</a></div><div class="site-copyright"><a href="https://en.wikipedia.org/wiki/Canonical_link_element" target="_blank" rel="noopener">reposting requires attribution, <strong>use canonical links</strong> Â»</a></div>

            
    
        <ul class="socials"><li class="socials-item">
                    <a href="/rss.xml" target="_blank" rel="external noopener" title="RSS"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="icon social-icon"><path d="M19.199 24C19.199 13.467 10.533 4.8 0 4.8V0c13.165 0 24 10.835 24 24h-4.801zM3.291 17.415c1.814 0 3.293 1.479 3.293 3.295 0 1.813-1.485 3.29-3.301 3.29C1.47 24 0 22.526 0 20.71s1.475-3.294 3.291-3.295zM15.909 24h-4.665c0-6.169-5.075-11.245-11.244-11.245V8.09c8.727 0 15.909 7.184 15.909 15.91z"/></svg></a>
                </li><li class="socials-item">
                    <a href="mailto:radek@gruchalski.com" target="_blank" rel="external noopener" title="Email"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon social-icon"><path d="M464 64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm0 48v40.805c-22.422 18.259-58.168 46.651-134.587 106.49-16.841 13.247-50.201 45.072-73.413 44.701-23.208.375-56.579-31.459-73.413-44.701C106.18 199.465 70.425 171.067 48 152.805V112h416zM48 400V214.398c22.914 18.251 55.409 43.862 104.938 82.646 21.857 17.205 60.134 55.186 103.062 54.955 42.717.231 80.509-37.199 103.053-54.947 49.528-38.783 82.032-64.401 104.947-82.653V400H48z"/></svg></a>
                </li><li class="socials-item">
                    <a href="https://github.com/radekg" target="_blank" rel="external noopener" title="GitHub"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="icon social-icon"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a>
                </li><li class="socials-item">
                    <a href="https://linkedin.com/in/radgruchalski" target="_blank" rel="external noopener" title="LinkedIn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon social-icon"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg></a>
                </li></ul>
    



            <p>this website uses Google Analytics but<br />
    it respects your DNT settings, stores tracking ID in session storage instead of cookies and anonymizes IP addresses </p>
        </div>
    </footer>


        </div>
        

        








    <script src="https://cdn.jsdelivr.net/npm/medium-zoom@latest/dist/medium-zoom.min.js"></script>

<script>
    mediumZoom(document.querySelectorAll('div.post-body img'), {
        background: 'hsla(var(--color-bg-h), var(--color-bg-s), var(--color-bg-l), 0.95)'
    })
</script>




    <script src="https://cdn.jsdelivr.net/npm/instant.page@5.1.0/instantpage.min.js" type="module" defer></script>







    </body>
</html>
