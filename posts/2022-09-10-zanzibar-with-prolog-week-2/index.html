<!DOCTYPE html>
<html lang="en">
    <head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
    <meta charset="UTF-8" />

    <meta name="generator" content="Hugo 0.148.2"><meta name="theme-color" content="#fff" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <meta name="format-detection" content="telephone=no, date=no, address=no, email=no" />
    
    <meta http-equiv="Cache-Control" content="no-transform" />
    
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    <title>Zanzibar with Prolog, week 2 | gruchalski.com</title>

    <link rel="stylesheet" href="/css/meme.min.fe3b4eabe26125d7716d7271d1dcc928f862e422b39cc80a8c45354f89084434.css"/>

    
    
        <script src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js" defer></script><script src="/js/meme.min.1321582b41a9fdb1a15023a3d3204fa013ace575e4c594c9dbc43078a016fce0.js"></script>

    

    <link rel="stylesheet" href="/assets/fonts/amaranth.css?family=IBM&#43;Plex&#43;Serif:ital,wght@0,400;0,500;0,700;1,400;1,700&amp;family=Source&#43;Code&#43;Pro:ital,wght@0,400;0,700;1,400;1,700&amp;family=Amaranth&amp;display=swap" media="print" onload="this.media='all'" />
        <noscript><link rel="stylesheet" href="/assets/fonts/amaranth.css?family=IBM&#43;Plex&#43;Serif:ital,wght@0,400;0,500;0,700;1,400;1,700&amp;family=Source&#43;Code&#43;Pro:ital,wght@0,400;0,700;1,400;1,700&amp;family=Amaranth&amp;display=swap" /></noscript>

    <meta name="author" content="Radek Gruchalski" /><meta name="description" content="I’ve been working my way through The Art of Prolog. The book is a fantastic eye-opener. The first five chapters are very science-heavy as they cover all Prolog principles. What follows are the twenty or so delightful, short, but on-subject chapters explaining the Prolog language in detail. I have a couple of chapters left to go through. I am looking forward to the compiler example from chapter 24.
" />

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#2a6df4" />
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-title" content="gruchalski.com" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="application-name" content="gruchalski.com" />
    <meta name="msapplication-starturl" content="../../" />
    <meta name="msapplication-TileColor" content="#fff" />
    <meta name="msapplication-TileImage" content="../../icons/mstile-150x150.png" />
    <link rel="manifest" href="/manifest.json" />

    
    

    
    
        <link rel="canonical" href="https://gruchalski.com/posts/2022-09-10-zanzibar-with-prolog-week-2/" />
    

    

<script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "datePublished": "2022-09-10T00:00:00+02:00",
        "dateModified": "2023-07-04T23:40:31+02:00",
        "url": "https://gruchalski.com/posts/2022-09-10-zanzibar-with-prolog-week-2/",
        "headline": "Zanzibar with Prolog, week 2",
        "description": "I’ve been working my way through The Art of Prolog. The book is a fantastic eye-opener. The first five chapters are very science-heavy as they cover all Prolog principles. What follows are the twenty or so delightful, short, but on-subject chapters explaining the Prolog language in detail. I have a couple of chapters left to go through. I am looking forward to the compiler example from chapter 24.\n",
        "inLanguage" : "en",
        "articleSection": "posts",
        "wordCount":  1558 ,
        "image": "https://gruchalski.com/icons/apple-touch-icon.png",
        "author": {
            "@type": "Person",
            "url": "https://gruchalski.com/",
            
        },
        "license": "[reposting requires attribution, **use canonical links** »](https://en.wikipedia.org/wiki/Canonical_link_element)",
        "publisher": {
            "@type": "Organization",
            "name": "gruchalski.com",
            "logo": {
                "@type": "ImageObject",
                "url": "https://gruchalski.com/icons/apple-touch-icon.png"
            },
            "url": "https://gruchalski.com/"
        },
        "mainEntityOfPage": {
            "@type": "WebSite",
            "@id": "https://gruchalski.com/"
        }
    }
</script>

    

<meta name="twitter:card" content="summary" />


    



<meta property="og:title" content="Zanzibar with Prolog, week 2" />
<meta property="og:description" content="I’ve been working my way through The Art of Prolog. The book is a fantastic eye-opener. The first five chapters are very science-heavy as they cover all Prolog principles. What follows are the twenty or so delightful, short, but on-subject chapters explaining the Prolog language in detail. I have a couple of chapters left to go through. I am looking forward to the compiler example from chapter 24.
" />
<meta property="og:url" content="https://gruchalski.com/posts/2022-09-10-zanzibar-with-prolog-week-2/" />
<meta property="og:site_name" content="gruchalski.com" />
<meta property="og:locale" content="en" /><meta property="og:image" content="/assets/posts/2022-09-10/header.jpg" />
<meta property="og:type" content="article" />
    <meta property="article:published_time" content="2022-09-10T00:00:00&#43;02:00" />
    <meta property="article:modified_time" content="2023-07-04T23:40:31&#43;02:00" />
    
    <meta property="article:section" content="posts" />



    
    

    
    <script async 
        src="https://analytics.svcs.sh/script.js"
        data-website-id="791140b3-1642-400d-82b9-6adcd1095688"
        data-do-not-track="true"
        data-domains="gruchalski.com"></script>

    
</head>

    <body>
        <div class="container">
            
    <header class="header">
        
            <div class="header-wrapper">
                <div class="header-inner single">
                    
    <div class="site-brand">
        
            <a href="/" class="brand">gruchalski.com</a>
        
    </div>

                    <nav class="nav">
    <ul class="menu" id="menu">
        
            
        
        
        
        
            
                <li class="menu-item"><a href="/posts/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon archive"><path d="M32 448c0 17.7 14.3 32 32 32h384c17.7 0 32-14.3 32-32V160H32v288zm160-212c0-6.6 5.4-12 12-12h104c6.6 0 12 5.4 12 12v8c0 6.6-5.4 12-12 12H204c-6.6 0-12-5.4-12-12v-8zM480 32H32C14.3 32 0 46.3 0 64v48c0 8.8 7.2 16 16 16h480c8.8 0 16-7.2 16-16V64c0-17.7-14.3-32-32-32z"/></svg><span class="menu-item-name">posts</span></a>
                </li>
            
        
            
                <li class="menu-item"><a href="/categories/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" class="icon code-branch"><path d="M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z"/></svg><span class="menu-item-name">categories</span></a>
                </li>
            
        
            
                <li class="menu-item"><a href="/tags/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" class="icon tags"><path d="M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z"/></svg><span class="menu-item-name">tags</span></a>
                </li>
            
        
            
                <li class="menu-item"><a href="/about/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" class="icon user-circle"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 96c48.6 0 88 39.4 88 88s-39.4 88-88 88-88-39.4-88-88 39.4-88 88-88zm0 344c-58.7 0-111.3-26.6-146.5-68.2 18.8-35.4 55.6-59.8 98.5-59.8 2.4 0 4.8.4 7.1 1.1 13 4.2 26.6 6.9 40.9 6.9 14.3 0 28-2.7 40.9-6.9 2.3-.7 4.7-1.1 7.1-1.1 42.9 0 79.7 24.4 98.5 59.8C359.3 421.4 306.7 448 248 448z"/></svg><span class="menu-item-name">about</span></a>
                </li>
            
        
            
                <li class="menu-item"><a href="/privacy/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 192 512" class="icon info"><path d="M20 424.229h20V279.771H20c-11.046 0-20-8.954-20-20V212c0-11.046 8.954-20 20-20h112c11.046 0 20 8.954 20 20v212.229h20c11.046 0 20 8.954 20 20V492c0 11.046-8.954 20-20 20H20c-11.046 0-20-8.954-20-20v-47.771c0-11.046 8.954-20 20-20zM96 0C56.235 0 24 32.235 24 72s32.235 72 72 72 72-32.235 72-72S135.764 0 96 0z"/></svg><span class="menu-item-name">privacy</span></a>
                </li>
            
        
            
                <li class="menu-item"><a href=""></a>
                </li>
            
        
            
                
            
        
    </ul>
</nav>

                    
                </div>
            </div>
            
    <input type="checkbox" id="nav-toggle" aria-hidden="true" />
    <label for="nav-toggle" class="nav-toggle"></label>
    <label for="nav-toggle" class="nav-curtain"></label>


        
    </header>




            
            
    <main class="main single" id="main">
    <div class="main-inner">

        

        <article class="content post h-entry" data-align="default" data-type="posts" data-toc-num="true">

            <h1 class="post-title p-name">Zanzibar with Prolog, week 2</h1>

            

            
                
            

            
                

<div class="post-meta">
    
        
        <time datetime="2022-09-10T00:00:00&#43;02:00" class="post-meta-item published dt-published"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon post-meta-icon"><path d="M148 288h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm108-12v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 96v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm192 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96-260v352c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h48c26.5 0 48 21.5 48 48zm-48 346V160H48v298c0 3.3 2.7 6 6 6h340c3.3 0 6-2.7 6-6z"/></svg>&nbsp;September 10, 2022</time>
    
    
    
    
        
        
        
    
    
        
        <span class="post-meta-item wordcount"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon post-meta-icon"><path d="M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3 0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9 0l60.1 60.1c18.8 18.7 18.8 49.1 0 67.9zM284.2 99.8L21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3 0-17l-111-111c-4.8-4.7-12.4-4.7-17.1 0zM124.1 339.9c-5.5-5.5-5.5-14.3 0-19.8l154-154c5.5-5.5 14.3-5.5 19.8 0s5.5 14.3 0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8 0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"/></svg>&nbsp;1558</span>
    
    
        
        <span class="post-meta-item reading-time"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon post-meta-icon"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm61.8-104.4l-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"/></svg>&nbsp;8&nbsp;mins</span>
    
    
    
</div>

            

            
                <img src="/assets/posts/2022-09-10/header.jpg" alt="thumbnail" class="p-article__thumbnail">
            

            <div class="post-body e-content">
              <p>I&rsquo;ve been working my way through <em>The Art of Prolog</em>. The book is a fantastic eye-opener. The first five chapters are very science-heavy as they cover all Prolog principles. What follows are the twenty or so delightful, short, but on-subject chapters explaining the Prolog language in detail. I have a couple of chapters left to go through. I am looking forward to the compiler example from chapter 24.</p>
<p>However, I do have a couple of research problems to look at.</p>
<div>
    <h2>table of contents</h2>
    <nav id="TableOfContents">
  <ol>
    <li><a href="#on-swi-prolog">on (SWI-)Prolog</a></li>
    <li><a href="#last-weeks-problems">last week&rsquo;s problems</a>
      <ol>
        <li><a href="#general-fact-container">general fact container</a></li>
        <li><a href="#providing-a-type-of-the-fact-to-the-query">providing a type of the fact to the query</a></li>
      </ol>
    </li>
    <li><a href="#next-steps">next steps</a></li>
    <li><a href="#scratching-the-itch">scratching the itch</a></li>
  </ol>
</nav>
</div>
<h2 id="on-swi-prolog"><a href="#on-swi-prolog" class="anchor-link">§</a>on (SWI-)Prolog</h2>
<p>Before I jump into that, though, some thoughts on Prolog.</p>
<p>What strikes me when writing Prolog code: <em>what</em>, not <em>how</em>. Solving a Problem in Prolog puts the focus on data flow. A continuous data transformation. <em>The Zen</em> of the thought process is minted in composable predicates, which the Prolog VM uses to solve the problem at hand.</p>
<p>I had such an <em>aha moment</em> six years ago when I was learning Erlang. Bugs appear when the logic applied to the problem isn&rsquo;t correct.</p>
<p>There are no loops, no syntactical conditionals, no return statements, and no state mutation. There is so little noise in the code. Individual predicates replacing traditional conditional branches from imperative languages make the reasoning about each branch easy to follow and test. The code is much more composable and ready to test in isolation. Now I remember why I enjoyed Erlang so much. There is one more language family  with such utility—everything Lisp, everything S-expressions.</p>
<p>Prolog is not your grandma&rsquo;s programming language. Definitely not SWI-Prolog, a Prolog implementation actively developed since 1985. It&rsquo;s a very modern platform for any task one can imagine having today.</p>
<p>On top of my head:</p>
<ul>
<li>TCP, UDP, sockets.</li>
<li>HTTP servers.</li>
<li>TLS support.</li>
<li>Multi-threading.</li>
<li>RocksDB.</li>
<li>Paxos library.</li>
<li>Protocol buffers.</li>
<li>Coherent testing story.</li>
<li>Official Docker image in the Docker Hub, running programs in containers.</li>
<li>C and Java interoperability.</li>
</ul>
<p>That, and more, is what SWI-Prolog offers. I haven&rsquo;t had a chance yet to try Scryer Prolog or Ichiban Prolog, but I expect that having a combination of Prolog and a powerful, expressive, imperative language available within a single program can be a huge productivity boost.</p>
<h2 id="last-weeks-problems"><a href="#last-weeks-problems" class="anchor-link">§</a>last week&rsquo;s problems</h2>
<p>In the <a href="/posts/2022-09-03-zanzibar-style-acls-with-prolog/#summary">Zanzibar-style ACLs in Prolog</a><sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">[1]</a></sup> article, I experienced a couple of problems prohibiting general applicability to <em>many children, single parent</em> permission inheritance. My original implementation used hard-coded <em>document</em> and <em>directory</em> fact predicates inside of the <code>inherits/3</code> and API code. I outlined a couple of possible improvements:</p>
<ul>
<li>Find a way to provide the type of fact to query for.</li>
<li>Or create a general fact container.</li>
</ul>
<p>Both are equally easy to implement, but there are significant differences in the user experience.</p>
<h3 id="general-fact-container"><a href="#general-fact-container" class="anchor-link">§</a>general fact container</h3>
<p>The inheritance resolution program requires something to resolve the parent of an object with a given ID to traverse the inheritance tree. Given an ID, fetch the parent reference and use it further to seek a solution. Given:</p>
<ul>
<li>A needle name in form of an atom</li>
<li>A compound container term.</li>
</ul>
<p>Find the compound member named like the atom inside of the container term. For example:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-prolog" data-lang="prolog"><span class="line"><span class="cl"><span class="nf">search_compound</span><span class="p">(</span><span class="s">parent</span><span class="p">,</span> <span class="nf">directory</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nf">dirname</span><span class="p">(</span><span class="s">&#39;documents&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="nf">objectid</span><span class="p">(</span><span class="s">&#39;b94c1f40-818b-47be-882b-ce1a8fbee254&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="nf">parent</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="nf">objectid</span><span class="p">(</span><span class="s">&#39;851a7566-b83d-4993-bd04-9b8244091d45&#39;</span><span class="p">))),</span> <span class="nv">Out</span><span class="p">).</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>Given the <code>directory(...)</code> term, the <code>Out</code> value should be <code>parent(objectid('851a7566-b83d-4993-bd04-9b8244091d45'))</code>. Frankly, anything that contains <code>parent(...)</code> should be handled the same way. This problem can be solved by using a couple of built-ins: <code>functor/3</code> and <code>arg/3</code>. Here&rsquo;s my solution:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-prolog" data-lang="prolog"><span class="line"><span class="cl"><span class="nf">search_compound</span><span class="p">(</span><span class="nv">Atom</span><span class="p">,</span> <span class="nv">Term</span><span class="p">,</span> <span class="nv">Out</span><span class="p">)</span> <span class="p">:-</span>
</span></span><span class="line"><span class="cl">    <span class="nf">compound</span><span class="p">(</span><span class="nv">Term</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="nf">functor</span><span class="p">(</span><span class="nv">Term</span><span class="p">,</span> <span class="k">_</span><span class="p">,</span> <span class="nv">Y</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="nf">search_compound</span><span class="p">(</span><span class="nv">Atom</span><span class="p">,</span> <span class="nv">Term</span><span class="p">,</span> <span class="nv">Out</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nv">Y</span><span class="p">).</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">search_compound</span><span class="p">(</span><span class="nv">Atom</span><span class="p">,</span> <span class="nv">Term</span><span class="p">,</span> <span class="nv">Value</span><span class="p">,</span> <span class="nv">N</span><span class="p">,</span> <span class="k">_</span><span class="p">)</span> <span class="p">:-</span>
</span></span><span class="line"><span class="cl">    <span class="nf">atom</span><span class="p">(</span><span class="nv">Atom</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="nf">arg</span><span class="p">(</span><span class="nv">N</span><span class="p">,</span> <span class="nv">Term</span><span class="p">,</span> <span class="nv">Value</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="nf">compound</span><span class="p">(</span><span class="nv">Value</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="c1">% To support compounds with arity 0,</span>
</span></span><span class="line"><span class="cl">    <span class="c1">% change the functor/3 below to</span>
</span></span><span class="line"><span class="cl">    <span class="c1">% compound_name_arity/3.</span>
</span></span><span class="line"><span class="cl">    <span class="c1">% **Warning**: This is SWI-Prolog specific, it may not work in other Prolog implementations.</span>
</span></span><span class="line"><span class="cl">    <span class="nf">functor</span><span class="p">(</span><span class="nv">Value</span><span class="p">,</span> <span class="nv">Atom</span><span class="p">,</span> <span class="k">_</span><span class="p">).</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">search_compound</span><span class="p">(</span><span class="nv">Atom</span><span class="p">,</span> <span class="nv">Term</span><span class="p">,</span> <span class="nv">Out</span><span class="p">,</span> <span class="nv">N</span><span class="p">,</span> <span class="nv">T</span><span class="p">)</span> <span class="p">:-</span>
</span></span><span class="line"><span class="cl">    <span class="nv">N</span> <span class="o">&lt;</span> <span class="nv">T</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nv">M</span> <span class="o">is</span> <span class="nv">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nf">search_compound</span><span class="p">(</span><span class="nv">Atom</span><span class="p">,</span> <span class="nv">Term</span><span class="p">,</span> <span class="nv">Out</span><span class="p">,</span> <span class="nv">M</span><span class="p">,</span> <span class="nv">T</span><span class="p">).</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>This code, given any valid compound, will figure out its arity and recursively try to find an argument with the name under an atom. This solution works pretty well, except for two issues:</p>
<ul>
<li>An argument cannot be of zero arity because the <code>functor/3</code> predicate raises an exception in that case. For example:</li>
</ul>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-prolog" data-lang="prolog"><span class="line"><span class="cl"><span class="nf">search_compound</span><span class="p">(</span><span class="s">parent</span><span class="p">,</span> <span class="nf">directory</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nf">whatever</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">    <span class="nf">dirname</span><span class="p">(</span><span class="s">&#39;documents&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="nf">objectid</span><span class="p">(</span><span class="s">&#39;b94c1f40-818b-47be-882b-ce1a8fbee254&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="nf">parent</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="nf">objectid</span><span class="p">(</span><span class="s">&#39;851a7566-b83d-4993-bd04-9b8244091d45&#39;</span><span class="p">))),</span> <span class="nv">Out</span><span class="p">).</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">% ERROR: Domain error: `compound_non_zero_arity&#39; expected, found `whatever()&#39;</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>But this will be fine:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-prolog" data-lang="prolog"><span class="line"><span class="cl"><span class="nf">search_compound</span><span class="p">(</span><span class="s">whatever</span><span class="p">,</span> <span class="nf">directory</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nf">whatever</span><span class="p">(</span><span class="s">nil</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="nf">dirname</span><span class="p">(</span><span class="s">&#39;documents&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="nf">objectid</span><span class="p">(</span><span class="s">&#39;b94c1f40-818b-47be-882b-ce1a8fbee254&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="nf">parent</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="nf">objectid</span><span class="p">(</span><span class="s">&#39;851a7566-b83d-4993-bd04-9b8244091d45&#39;</span><span class="p">))),</span> <span class="nv">Out</span><span class="p">).</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1">% Out = whatever(nil).</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><ul>
<li>The second problem is that the, in this case, <code>directory(...)</code> term has to be available at the call site. As in, it has to come from some other call site. Ergo, it must be fully typed by someone into the program. A usual case would be to have a bunch of facts in a global database, as I had in my previous article, and I would like to reference those. Hence, I would like to avoid having to type them in. But, it&rsquo;s not trivial to take a reference to a term of possibly variable arity and pass it as an argument. Prolog provides meta-programming facilities allowing a term to be reconstructed at run time, but it&rsquo;s not trivial.</li>
</ul>
<p>I&rsquo;m happy with the code, but for the reasons above, I don&rsquo;t like this solution.</p>
<h3 id="providing-a-type-of-the-fact-to-the-query"><a href="#providing-a-type-of-the-fact-to-the-query" class="anchor-link">§</a>providing a type of the fact to the query</h3>
<p>In imperative language, I would consider solving this problem by passing a closure that, given an ID of an object, returns the parent reference. Prolog does not offer closures, but it has something that can be compared to a closure, if you squint hard enough&hellip; Consider the following code:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-prolog" data-lang="prolog"><span class="line"><span class="cl"><span class="s">?-</span> <span class="nf">assertz</span><span class="p">(</span><span class="nf">hello</span><span class="p">(</span><span class="nv">Arg</span><span class="p">)</span> <span class="p">:-</span> <span class="nf">format</span><span class="p">(</span><span class="s">&#39;Hello, world, you said: ~q!~n&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nv">Arg</span><span class="p">])).</span>
</span></span><span class="line"><span class="cl"><span class="s">true</span><span class="p">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s">?-</span> <span class="nv">Proc</span> <span class="o">=</span> <span class="nf">hello</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">).</span>
</span></span><span class="line"><span class="cl"><span class="nv">Proc</span> <span class="o">=</span> <span class="nf">hello</span><span class="p">(</span><span class="s">a</span><span class="p">).</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s">?-</span> <span class="nv">Proc</span> <span class="o">=</span> <span class="nf">hello</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">),</span> <span class="nv">Proc</span><span class="p">.</span>
</span></span><span class="line"><span class="cl"><span class="nv">Hello</span><span class="p">,</span> <span class="s">world</span><span class="p">,</span> <span class="s">you</span> <span class="nn">said</span><span class="p">:</span> <span class="s">a</span><span class="p">!</span>
</span></span><span class="line"><span class="cl"><span class="nv">Proc</span> <span class="o">=</span> <span class="nf">hello</span><span class="p">(</span><span class="s">a</span><span class="p">).</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>What happens here, <em>Proc</em> is given the predicate <code>hello('a')</code> as a value, the standalone <em>Proc.</em> calls that value as a predicate. We can make it better using the built-in <code>=..</code> (<em>univ</em>) predicate to construct a call site from arguments. Here&rsquo;s a rudimentary example:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-prolog" data-lang="prolog"><span class="line"><span class="cl"><span class="s">?-</span> <span class="nf">assertz</span><span class="p">((</span><span class="nf">call_it</span><span class="p">(</span><span class="nv">Atom</span><span class="p">,</span> <span class="nv">Arg</span><span class="p">)</span> <span class="p">:-</span> <span class="nv">Proc</span> <span class="s">=..</span> <span class="p">[</span><span class="nv">Atom</span><span class="p">,</span> <span class="nv">Arg</span><span class="p">],</span> <span class="nv">Proc</span><span class="p">)).</span>
</span></span><span class="line"><span class="cl"><span class="s">true</span><span class="p">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s">?-</span> <span class="nf">call_it</span><span class="p">(</span><span class="s">hello</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">).</span>
</span></span><span class="line"><span class="cl"><span class="nv">Hello</span><span class="p">,</span> <span class="s">world</span><span class="p">,</span> <span class="s">you</span> <span class="nn">said</span><span class="p">:</span> <span class="s">a</span><span class="p">!</span>
</span></span><span class="line"><span class="cl"><span class="s">true</span><span class="p">.</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>This is much more promising than the previous solution. Using the construct above, I have arrived at the following example:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-prolog" data-lang="prolog"><span class="line"><span class="cl"><span class="nf">entity</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nf">objectid</span><span class="p">(</span><span class="s">&#39;851a7566-b83d-4993-bd04-9b8244091d45&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="nf">parent</span><span class="p">(</span><span class="nf">objectid</span><span class="p">()),</span>
</span></span><span class="line"><span class="cl">    <span class="nf">metadata</span><span class="p">([</span><span class="s">type</span><span class="p">,</span> <span class="s">directory</span><span class="p">,</span> <span class="s">name</span><span class="p">,</span> <span class="s">&#39;data&#39;</span><span class="p">])).</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">find_parent</span><span class="p">(</span><span class="nv">Id</span><span class="p">,</span> <span class="nv">Out</span><span class="p">)</span> <span class="p">:-</span>
</span></span><span class="line"><span class="cl">    <span class="nv">ProcCall</span> <span class="s">=..</span> <span class="p">[</span><span class="s">parent_resolver</span><span class="p">,</span> <span class="nv">Id</span><span class="p">,</span> <span class="nv">Out</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nv">ProcCall</span><span class="p">.</span> <span class="c1">% I could use call(ProcCall) but this does the job.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">% The user of the API need to provide this predicate:</span>
</span></span><span class="line"><span class="cl"><span class="nf">parent_resolver</span><span class="p">(</span><span class="nv">Id</span><span class="p">,</span> <span class="nv">Out</span><span class="p">)</span> <span class="p">:-</span>
</span></span><span class="line"><span class="cl">    <span class="nf">entity</span><span class="p">(</span><span class="nf">objectid</span><span class="p">(</span><span class="nv">Id</span><span class="p">),</span> <span class="nv">Out</span><span class="p">,</span> <span class="k">_</span><span class="p">).</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>And the call:</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-prolog" data-lang="prolog"><span class="line"><span class="cl"><span class="s">?-</span> <span class="nf">find_parent</span><span class="p">(</span><span class="s">&#39;851a7566-b83d-4993-bd04-9b8244091d45&#39;</span><span class="p">,</span> <span class="nv">Out</span><span class="p">).</span>
</span></span><span class="line"><span class="cl"><span class="nv">Out</span> <span class="o">=</span> <span class="nf">parent</span><span class="p">(</span><span class="nf">objectid</span><span class="p">()).</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>Yes, this is much better. The <code>find_parent/3</code> predicate would be called by existing <code>inherits/3</code>. The user would be required to provide their <code>parent_resolver/2</code>, which makes sense as the user knows the structure of the compound they work with.</p>
<h2 id="next-steps"><a href="#next-steps" class="anchor-link">§</a>next steps</h2>
<p>The immediate next step is to integrate this into the actual program so that I have a general inheritance API. The next problem is more interesting: the distribution of the individual facts close to the compute so that a small Prolog program can use a minimum necessary number of facts required to make a decision. The simplest way of doing it is to provide something similar to the Open Policy Agent bundles.</p>
<p>The second step is a little bit more mundane task to provide a trace facility to the user so that the user knows why permission is granted or denied. Similar to the Open Policy Agent playground trace feature, or the explanation API in Keto. A pure Prolog recipe exists in chapter 17 of <em>The Art of Prolog</em>.</p>
<h2 id="scratching-the-itch"><a href="#scratching-the-itch" class="anchor-link">§</a>scratching the itch</h2>
<p>Having solved this problem in OPA and Prolog, I&rsquo;m pretty confident the permissions API does not need a database to work. Neither does one want a database for this because:</p>
<ul>
<li>A single-node RDBMS will be a single point of failure, always.</li>
<li>Building and operating a leader/follower RDBMS setup reliably is not easy.</li>
<li>A distributed RDBMS is a massive cost and operational factor.</li>
</ul>
<p>OPA is the best example of how to do this best. Rego is very lightweight. The OPA VM is embeddable and available in many programming languages as a library.</p>
<p>That makes it easy to move the compute very close to where the problem is, even into the actual application. Inside of the application, that&rsquo;s where this journey started for me two years ago. I was trying to <em>scratch my itch</em>, which was to provide permissions API to Firebuild. Today, I know I could have used OPA. But I now understand why that would have been the best choice back then.</p>
<p>The problem is not in querying for permissions, the problem is in bringing the facts to where the decision has to be made. The key to solving this in Prolog is sticking to standard Prolog and leveraging whatever implementation there exists for a programming language a developer is using for their application.</p>
<p>Time to refocus and bring two years&rsquo; worth of learnings together.</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><a href="/posts/2022-09-03-zanzibar-style-acls-with-prolog/#summary">Zanzibar-style ACLs in Prolog</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" class="icon footnote-icon"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6 0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9 0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9 0L7 329.7c-9.4-9.4-9.4-24.6 0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg></a></p>
</li>
</ol>
</div>

            </div>

            
    
    



        </article>

        

        


        


        <div class="post-share">

        

        <div class="share-items">

            
                <div class="share-item twitter">
                    
                    <a href="https://twitter.com/share?url=https://gruchalski.com/posts/2022-09-10-zanzibar-with-prolog-week-2/&amp;text=Zanzibar%20with%20Prolog,%20week%202&amp;hashtags=Prolog,Zanzibar,Opa,Keto,Firebuild,&amp;via=%25!s%28%3cnil%3e%29" title="Share on Twitter" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon twitter-icon"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></a>
                </div>
            

            

            
                <div class="share-item linkedin">
                    
                    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://gruchalski.com/posts/2022-09-10-zanzibar-with-prolog-week-2/&amp;title=Zanzibar%20with%20Prolog,%20week%202&amp;summary=I%e2%80%99ve%20been%20working%20my%20way%20through%20The%20Art%20of%20Prolog.%20The%20book%20is%20a%20fantastic%20eye-opener.%20The%20first%20five%20chapters%20are%20very%20science-heavy%20as%20they%20cover%20all%20Prolog%20principles.%20What%20follows%20are%20the%20twenty%20or%20so%20delightful,%20short,%20but%20on-subject%20chapters%20explaining%20the%20Prolog%20language%20in%20detail.%20I%20have%20a%c2%a0couple%20of%20chapters%20left%20to%20go%20through.%20I%20am%20looking%20forward%20to%20the%20compiler%20example%20from%20chapter%2024.%0a&amp;source=gruchalski.com" title="Share on LinkedIn" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon linkedin-icon"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg></a>
                </div>
            

            

            

            

            

            

            
                <div class="share-item qrcode">
                    <div class="qrcode-container" title="Share via QR Code"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon qrcode-icon"><path d="M0 224h192V32H0v192zM64 96h64v64H64V96zm192-64v192h192V32H256zm128 128h-64V96h64v64zM0 480h192V288H0v192zm64-128h64v64H64v-64zm352-64h32v128h-96v-32h-32v96h-64V288h96v32h64v-32zm0 160h32v32h-32v-32zm-64 0h32v32h-32v-32z"/></svg><div id="qrcode-img"></div>
                    </div>
                    <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js"></script>

<script>
    var typeNumber = 0;
    var errorCorrectionLevel = 'L';
    var qr = qrcode(typeNumber, errorCorrectionLevel);
    qr.addData('https:\/\/gruchalski.com\/posts\/2022-09-10-zanzibar-with-prolog-week-2\/');
    qr.make();
    document.getElementById('qrcode-img').innerHTML = qr.createImgTag();
</script>

                </div>
            

        </div>

    </div>




        
    
    
        <div class="related-posts">
            <h2 class="related-title">See Also:<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon related-icon"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"/></svg></h2>
            <ul class="related-list">
                
                    <li class="related-item">
                        <a href="/posts/2022-09-03-zanzibar-style-acls-with-prolog/" class="related-link">Zanzibar-style ACLs with Prolog</a>
                    </li>
                
                    <li class="related-item">
                        <a href="/posts/2022-04-27-opa-logical-or-conditions/" class="related-link">OPA: logical or conditions</a>
                    </li>
                
                    <li class="related-item">
                        <a href="/posts/2022-10-22-zanzibar-with-prolog-summary/" class="related-link">Zanzibar with Prolog - summary</a>
                    </li>
                
                    <li class="related-item">
                        <a href="/posts/2022-05-07-zanzibar-style-acls-with-opa-rego/" class="related-link">Zanzibar-style ACLs with OPA Rego</a>
                    </li>
                
                    <li class="related-item">
                        <a href="/posts/2021-05-17-keto-rbac-listing-roles-of-a-user/" class="related-link">Keto RBAC - listing roles of a user</a>
                    </li>
                
            </ul>
        </div>
    



        
    
        <div class="post-tags">
            
                
                
                
                
                    
                    <a href="/tags/prolog/" rel="tag" class="post-tags-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon tag-icon"><path d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg>Prolog</a>
                
            
                
                
                
                
                    
                    <a href="/tags/zanzibar/" rel="tag" class="post-tags-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon tag-icon"><path d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg>Zanzibar</a>
                
            
                
                
                
                
                    
                    <a href="/tags/opa/" rel="tag" class="post-tags-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon tag-icon"><path d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg>Opa</a>
                
            
                
                
                
                
                    
                    <a href="/tags/keto/" rel="tag" class="post-tags-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon tag-icon"><path d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg>Keto</a>
                
            
                
                
                
                
                    
                    <a href="/tags/firebuild/" rel="tag" class="post-tags-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon tag-icon"><path d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg>Firebuild</a>
                
            
        </div>
    



        


        


        
    
        
        
    
    
    
    
        <ul class="post-nav">
            
                <li class="post-nav-prev">
                    <a href="/posts/2022-10-22-zanzibar-with-prolog-summary/" rel="prev">&lt; Zanzibar with Prolog - summary</a>
                </li>
            
            
                <li class="post-nav-next">
                    <a href="/posts/2022-09-03-zanzibar-style-acls-with-prolog/" rel="next">Zanzibar-style ACLs with Prolog &gt;</a>
                </li>
            
        </ul>
    



        


    </div>
</main>


            
    <div id="back-to-top" class="back-to-top">
        <a href="#"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon arrow-up"><path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6 0-33.9L207 39c9.4-9.4 24.6-9.4 33.9 0l194.3 194.3c9.4 9.4 9.4 24.6 0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3 0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"/></svg></a>
    </div>


            
    <footer id="footer" class="footer">
        <div class="footer-inner">
            <div class="site-info">©&nbsp;2015–2025&nbsp;<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon footer-icon"><path d="M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3 0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"/></svg>&nbsp;</div><div class="powered-by">Powered by <a href="https://github.com/gohugoio/hugo" target="_blank" rel="noopener">Hugo</a> | Theme is <a href="https://github.com/reuixiy/hugo-theme-meme" target="_blank" rel="noopener">MemE</a></div><div class="site-copyright"><a href="https://en.wikipedia.org/wiki/Canonical_link_element" target="_blank" rel="noopener">reposting requires attribution, <strong>use canonical links</strong> »</a></div>

            
    
        <ul class="socials"><li class="socials-item">
                    <a href="/rss.xml" target="_blank" rel="external noopener" title="RSS"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="icon social-icon"><path d="M19.199 24C19.199 13.467 10.533 4.8 0 4.8V0c13.165 0 24 10.835 24 24h-4.801zM3.291 17.415c1.814 0 3.293 1.479 3.293 3.295 0 1.813-1.485 3.29-3.301 3.29C1.47 24 0 22.526 0 20.71s1.475-3.294 3.291-3.295zM15.909 24h-4.665c0-6.169-5.075-11.245-11.244-11.245V8.09c8.727 0 15.909 7.184 15.909 15.91z"/></svg></a>
                </li><li class="socials-item">
                    <a href="mailto:radek@gruchalski.com" target="_blank" rel="external noopener" title="Email"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon social-icon"><path d="M464 64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm0 48v40.805c-22.422 18.259-58.168 46.651-134.587 106.49-16.841 13.247-50.201 45.072-73.413 44.701-23.208.375-56.579-31.459-73.413-44.701C106.18 199.465 70.425 171.067 48 152.805V112h416zM48 400V214.398c22.914 18.251 55.409 43.862 104.938 82.646 21.857 17.205 60.134 55.186 103.062 54.955 42.717.231 80.509-37.199 103.053-54.947 49.528-38.783 82.032-64.401 104.947-82.653V400H48z"/></svg></a>
                </li><li class="socials-item">
                    <a href="https://github.com/radekg" target="_blank" rel="external noopener" title="GitHub"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="icon social-icon"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a>
                </li><li class="socials-item">
                    <a href="https://linkedin.com/in/radgruchalski" target="_blank" rel="external noopener" title="LinkedIn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon social-icon"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg></a>
                </li></ul>
    



            
        </div>
    </footer>


        </div>
        

        








    <script src="https://cdn.jsdelivr.net/npm/medium-zoom@latest/dist/medium-zoom.min.js"></script>

<script>
    mediumZoom(document.querySelectorAll('div.post-body img'), {
        background: 'hsla(var(--color-bg-h), var(--color-bg-s), var(--color-bg-l), 0.95)'
    })
</script>




    <script src="https://cdn.jsdelivr.net/npm/instant.page@5.1.0/instantpage.min.js" type="module" defer></script>







    </body>
</html>
